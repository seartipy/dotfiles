#! /bin/bash

[ -d ~/.zgen ] || git clone https://github.com/tarjoilija/zgen.git ~/.zgen

ZGEN_PREZTO_LOAD_DEFAULT=false
source "${HOME}/.zgen/zgen.zsh"

[ -s ~/.zshrc-pre-local.sh ] && source ~/.zshrc-pre-local.sh

# check if there's no init script
if ! zgen saved; then
    echo "Creating a zgen save"

    # prezto options
    zgen prezto editor key-bindings 'emacs'
    zgen prezto editor dot-expansion 'yes'
    zgen prezto tmux:auto-start local 'no'
    zgen prezto prompt theme 'pure'
    zgen prezto terminal auto-title 'yes'
    zgen prezto utility:ls color 'yes'
    zgen prezto syntax-highlighting color 'yes'
    zgen prezto syntax-highlighting highlighters 'main' 'brackets'
    # zgen prezto tmux:iterm integrate 'yes'

    [ -s ~/.zgen-options-local.sh ] && source ~/.zgen-options-local.sh

    # prezto and modules
    zgen prezto
    zgen prezto environment
    zgen prezto utility
    zgen prezto terminal
    zgen prezto editor
    zgen prezto history
    zgen prezto directory
    zgen prezto spectrum
    zgen prezto completion                     # must be loaded after utility
    zgen prezto archive                        # lsarchive and unarchive commands
    zgen prezto git                            # git aliases
    zgen prezto command-not-found
    zgen prezto fasd                           # j , f, d etc.
    zgen prezto osx
    zgen prezto tmux
    zgen prezto syntax-highlighting
    zgen prezto history-substring-search
    zgen prezto autosuggestions

    # plugins
    zgen load djui/alias-tips
    zgen load rimraf/k
    zgen load unixorn/git-extra-commands

    [ -s ~/.zgen-plugins-local.sh ] && source ~/.zgen-plugins-local.sh

    zgen prezto prompt          # prompt must be the last module to load
    zgen save                   # save all to init script
fi

source "$HOME/seartipy/dotfiles/shellrc"

[ -s ~/.zshrc-post-local.sh ] && source ~/.zshrc-post-local.sh
